define ("tool_textcleanup/async_data_manager",["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){function f(a,c){var d=b.call([{methodname:a,args:c}])[0];return d}function g(a,b,c,e,h,i){f("tool_textcleanup_cleanup_text",{query:a,types:b,maxrecords:50}).done(function(d){i.text(e+"/"+c);if(d){if(0===d.cleanedrecords){h.prop("disabled",!1);i.text("")}else{g(a,b,c,e+d.cleanedrecords,h,i)}}}).fail(function(a){h.prop("disabled",!1);d.exception(a)})}return{init:function init(b,e,h,i){a("document").ready(function(){c.get_strings([{key:"dataloading",component:"tool_textcleanup"},{key:"reloaddata",component:"tool_textcleanup"}]).then(function(c){var j=a("#"+b+" [type=submit]").first();if(i){j.val(c[0])}else{j.val(c[1])}j.click(function(a){a.preventDefault();j.val(c[0]);j.prop("disabled",!0);f("tool_textcleanup_build_text_table",[]).done(function(){j.val(c[1]);j.prop("disabled",!1)}).fail(function(a){j.prop("disabled",!1);j.val(c[0]);d.exception(a)})});var k=a("#"+h).serializeArray(),l=a("#"+h+" #id_search").val(),m=k.map(function(a){return a.name.startsWith("types[")&&""!=a.value?a.value:null}).filter(function(a){return null!==a}),n=a("#"+e+" [type=submit]").first();n.addClass("btn-danger");n.click(function(b){b.preventDefault();n.prop("disabled",!0);var c=a("#infoarea");f("tool_textcleanup_get_count_search",{query:l,types:m}).done(function(a){if(a.searchcount){g(l,m,a.searchcount,0,n,c)}else{n.prop("disabled",!1)}}).fail(function(a){n.prop("disabled",!1);d.exception(a)})})}).fail(d.exception)})}}});
//# sourceMappingURL=async_data_manager.min.js.map
