define(["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){function e(a,c){var d={methodname:a,args:c},e=b.call([d])[0];return e}function f(a,b,c,h,i,j){e("tool_textcleanup_cleanup_text",{query:a,types:b,maxrecords:g}).done(function(d){j.text(h+"/"+c),d&&(0===d.cleanedrecords?(i.prop("disabled",!1),j.text("")):f(a,b,c,h,i,j))}).fail(function(a){i.prop("disabled",!1),d.exception(a)})}var g=10;return{init:function(b,g,h,i,j,k){a("document").ready(function(){c.get_strings([{key:"dataloading",component:"tool_textcleanup"},{key:"reloaddata",component:"tool_textcleanup"}]).then(function(c){var l=a("#"+b+" input[type=submit]").first();h?l.val(c[0]):l.val(c[1]),l.click(function(a){a.preventDefault(),l.val(c[0]),l.prop("disabled",!0),e("tool_textcleanup_build_text_table",[]).done(function(){l.val(c[1]),l.prop("disabled",!1)}).fail(function(a){l.prop("disabled",!1),l.val(c[0]),d.exception(a)})});var m=a("#"+g+" input[type=submit]").first();m.click(function(a){a.preventDefault(),m.prop("disabled",!0);var b=m.append("div");f(i,j,k,0,m,b)})}).fail(d.exception)})}}});